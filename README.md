# Markdown Formula
*markdown formula* is a Visual Studio Code extension which evaluates Excel-like formulas in markdown tables. To make markdown readable with other parsers and to emphazise that the cell value is the output of a formula, link style formatting is used to create a formula. The structure of a *markdown formula* consist of two parts:

    [VALUE]({=FORMULA})

Here, "=FORMULA" is the Excel-like formula which will be evaluated. The "VALUE" is the result of the "=FORMULA" and automatically generated by this extension. All the calculations are fulfilled via the popular open-source library [HyperFormula](https://handsontable.github.io/hyperformula/).

Using the Excel-like naming convention, table columns are addressed with letters (A,B,...) and the table rows are addressed with numbers (1,2,..). 

*markdown formula* parses all the tables in the current document and seperates them as sheets. If a comment line ('\<!-- NAME -->') exist just before the table header, it is assigned as the sheetname for the table. If a comment line does not exist, the sheet name is automatically generated as "Sheet#N" where the #N is the zero based order of the table in the document.

## Basic Example
In this basic example, we have a table which consist of five rows and three columns. The last column of the first two rows (namely C1 and C2) are used to construct the (C3:C5) rows.

<!-- table1 -->
| name           | formula         | values                   |
| -------------- | --------------- | ------------------------ |
| three          | -               | 3                        |
| eight          | -               | 8                        |
| summation      | =SUM(C1:C2)     | [11]({=SUM(C1:C2)})      |
| multiplication | =C1*C2          | [24]({=C1*C2})           |
| average        | =AVERAGE(C1:C2) | [5.5]({=AVERAGE(C1:C2)}) |

## Using Cells From Other Sheets
In this example, we will use the cells of the previous table in our current table.

<!-- table2-->
| name                  | formula                                   | values1                     | values2                     |
| --------------------- | ----------------------------------------- | --------------------------- | --------------------------- |
| six and one           | -                                         | 6                           | 1                           |
| summation from table1 | =table1!C3                                | 4                           | [11]({=table1!C3})          |
| summation and average | =SUM(C1:D2),=AVERAGE(C1:D2)               | [22]({=SUM(C1:D2)})         | [5.5]({=AVERAGE(C1:D2)})    |
| count larger than 3   | =COUNTIF(C1:C3,">3"),=COUNTIF(D1:D3,">3") | [3]({=COUNTIF(C1:C3,">3")}) | [2]({=COUNTIF(D1:D3,">3")}) |

## How to Use
Extension is not published in [VS Code Extension Marketplace](https://marketplace.visualstudio.com/vscode) yet. To use it you can use the prebuilt version under the release or build it from the source code.

1. Clone this repository.
2. Install "npm" and run "npm install -g vsce"
3. Change directory to MarkdownFormula and run "vsce package"
